# KerasToCpp - CPU

You may want to test a model you created using Keras in a C environment. This place was created to solve this problem. You can save the training weights of the model you created using Keras and then use it in the C environment. All layer and activation functions are designed to run using CPU. The layers created so far are as follows:

## Supported Keras layers

- ***Layers***
  - :white_check_mark: Dense
  - :white_check_mark: Conv2D
  - :white_check_mark: Flatten
  - :white_check_mark: MaxPooling2D
  - :white_check_mark: BatchNormalization
 
- ***Activations***
  - :white_check_mark: Sigmoid
  - :white_check_mark: ReLU
  

A sample project created using all layers can be accessed here: [Surface_Detection](https://github.com/fbasatemur/Surface_Detection)

## Design goals

- Compatibility with networks generated by Keras using TensorFlow backend.
- CPU only.
- No external dependencies, standard library, C++17.


## How to use Keras model weights in the C environment ?
Keras weights are in hdf5 file format. I assume you got the model record as .json and .h5.
You can create your model training weights as follows:

```ini
# keras library import  for Saving and loading model and weights

from keras.models import model_from_json
from keras.models import load_model

# serialize model to JSON
#  the keras model which is trained is defined as 'model' in this example
model_json = model.to_json()

with open("model_save_json.json", "w") as json_file:
    json_file.write(model_json)

# serialize weights to HDF5
model.save_weights("model_save_weight.h5")
```

It is converted to a text file for use with the C environment. You can do it as follows:

```ini
python h5_to_txt.py model_save_weight.h5
```

Each layer in the model will be saved in a folder and their weight in it. The text files will then be loaded into the model layers.
